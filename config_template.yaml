# HTTP ä»£ç†ç«¯å£
port: 7890

# SOCKS5 ä»£ç†ç«¯å£
socks-port: 7891

# Linux å’Œ macOS çš„ redir ä»£ç†ç«¯å£ (å¦‚éœ€ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·å–æ¶ˆæ³¨é‡Š)
# redir-port: 7892
# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: info
mode: rule
# ipv6 æ”¯æŒ
ipv6: true
# å…è®¸å±€åŸŸç½‘è¿æ¥
allow-lan: true
# Meta å†…æ ¸ç‰¹æ€§ https://wiki.metacubex.one/config/general
# ç»Ÿä¸€å»¶è¿Ÿ
# æ›´æ¢å»¶è¿Ÿè®¡ç®—æ–¹å¼,å»é™¤æ¡æ‰‹ç­‰é¢å¤–å»¶è¿Ÿ
unified-delay: true
# TCP å¹¶å‘
# åŒæ—¶å¯¹æ‰€æœ‰ipè¿›è¡Œè¿æ¥ï¼Œè¿”å›å»¶è¿Ÿæœ€ä½çš„åœ°å€
tcp-concurrent: true
# å¤–éƒ¨æ§åˆ¶ç«¯å£
external-controller: 127.0.0.1:9090

geodata-mode: true

# Geo æ•°æ®åº“ä¸‹è½½åœ°å€
# ä½¿ç”¨ FastGit ä»£ç† (https://fgit.cf)
# æºåœ°å€ https://github.com/MetaCubeX/meta-rules-dat
# å¯ä»¥æ›´æ¢é•œåƒç«™ä½†ä¸è¦æ›´æ¢å…¶ä»–æ•°æ®åº“ï¼Œå¯èƒ½å¯¼è‡´æ— æ³•å¯åŠ¨
geox-url:
  geoip: "https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/geoip.dat"
  geosite: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat"
  mmdb: "https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/Country.mmdb"
  asn: "https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/GeoLite2-ASN.mmdb"

# è¿›ç¨‹åŒ¹é…æ¨¡å¼
# è·¯ç”±å™¨ä¸Šè¯·è®¾ç½®ä¸º off
# always å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹
# strict é»˜è®¤ï¼Œç”± Clash åˆ¤æ–­æ˜¯å¦å¼€å¯
# off ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
find-process-mode: strict

# ç¼“è§£ç§»åŠ¨è®¾å¤‡è€—ç”µé—®é¢˜
# https://github.com/vernesong/OpenClash/issues/2614
keep-alive-interval: 1800

# å…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹
global-client-fingerprint: random # éšæœºæŒ‡çº¹

# ç¼“å­˜
profile:
  store-selected: true
  store-fake-ip: true

# è‡ªåŠ¨åŒæ­¥æ—¶é—´ä»¥é˜²æ­¢æ—¶é—´ä¸å‡†å¯¼è‡´æ— æ³•æ­£å¸¸è”ç½‘
ntp:
  enable: true
  # æ˜¯å¦åŒæ­¥è‡³ç³»ç»Ÿæ—¶é—´ï¼Œéœ€è¦ root/ç®¡ç†å‘˜æƒé™
  write-to-system: false
  server: time.apple.com
  port: 123
  interval: 30

# åŸŸåå—…æ¢
sniffer:
  enable: true
  sniff:
    TLS:
      ports: [443, 8443]
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true

# tun æ¨¡å¼
tun:
  enable: false  # enable 'true'
  device: utun
  stack: gvisor  # or 'gvisor'
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-detect-interface: true
  strict-route: true # å°†æ‰€æœ‰è¿æ¥è·¯ç”±åˆ° tun æ¥é˜²æ­¢æ³„æ¼ï¼Œä½†ä½ çš„è®¾å¤‡å°†æ— æ³•å…¶ä»–è®¾å¤‡è¢«è®¿é—® çƒ­ç‚¹å°†æ— æ³•å…±äº«ç½‘ç»œ
  include_android_user:
    - 0

# å†…ç½‘ç©¿é€
tunnels:
- network: [tcp, udp]
  address: 127.0.0.1:13000
  target: 192.168.1.88:8096
  proxy: ğŸ  Home

- network: [tcp, udp]
  address: 127.0.0.1:13001
  target: 192.168.1.180:445
  proxy: ğŸ  Home

- network: [tcp, udp]
  address: 127.0.0.1:13002
  target: 192.168.1.1:9090
  proxy: ğŸ  Home

- network: [tcp, udp]
  address: 127.0.0.1:13003
  target: 192.168.1.88:4533
  proxy: ğŸ  Home

- network: [tcp, udp]
  address: 127.0.0.1:13004
  target: 192.168.1.88:8971
  proxy: ğŸ  Home

# dns è®¾ç½®
# å·²é…ç½® ipv6
dns:
  cache-algorithm: arc # ARCï¼ˆAdaptive Replacement Cacheï¼‰ç¼“å­˜ç®—æ³•
  enable: true
  listen: :1053
  use-hosts: true
  ipv6: true
  ipv6-timeout: 300
  prefer-h3: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*'
    - '+.lan'
    - '+.local'
    - '+.leigod.com'
    - '+.vivox.com'
    - '+.stun.+'
    - '.n.n.srv.nintendo.net'
    - '+.stun.playstation.net'
    - 'xbox.*.*.microsoft.com'
    - '*.*.xboxlive.com'
    - 'lens.l.google.com'
    - '*.mcdn.bilivideo.cn'
    - 'localhost.ptlogin2.qq.com'
    - WORKGROUP
  default-nameserver:
    - tls://1.12.12.12:853
    - tls://223.5.5.5:853
    - h3://223.5.5.5/dns-query
    - h3://223.6.6.6/dns-query
    - https://223.5.5.5/dns-query 
    - tcp://119.29.29.29
    - tcp://223.6.6.6 
  nameserver:
    - quic://dns.adguard.com:784#DNS  # DNS over QUIC æµ‹è¯•
    - https://1.1.1.1/dns-query#DNS
    - https://1.0.0.1/dns-query#DNS
    - h3://223.5.5.5/dns-query
    - h3://223.6.6.6/dns-query
    - tls://223.5.5.5:853#DNS # DNS over TLS
    - https://doh.pub/dns-query#DNS # DNS over HTTPS
    - https://dns.alidns.com/dns-query#DNS&h3=true # å¼ºåˆ¶ HTTP/3ï¼Œä¸ perfer-h3 æ— å…³ï¼Œå¼ºåˆ¶å¼€å¯ DoH çš„ HTTP/3 æ”¯æŒï¼Œè‹¥ä¸æ”¯æŒå°†æ— æ³•ä½¿ç”¨
    - https://mozilla.cloudflare-dns.com/dns-query#DNS&h3=true # æŒ‡å®šç­–ç•¥ç»„å’Œä½¿ç”¨ HTTP/3
    - dhcp://en0#DNS  # dns from dhcp #æµ‹è¯•
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://doh.360.cn/dns-query
    - h3://223.5.5.5/dns-query
    - h3://223.6.6.6/dns-query
    - tls://223.5.5.5
    - tls://dot.pub
  nameserver-policy:
    geosite:cn,private:
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
      - h3://223.5.5.5/dns-query
      - h3://223.6.6.6/dns-query
      - tls://223.5.5.5
      - tls://dot.pub
    geosite:!cn,!private:
      - https://1.1.1.1/dns-query#DNS
      - https://104.16.132.229/dns-query#DNS
      - tls://dns.google#DNS
      - tls://cloudflare-dns.com#DNS
      - https://1.0.0.1/dns-query#DNS
      - quic://dns.adguard.com:784#DNS
      - quic://a.passcloud.xyz:784#DNS # quicæ˜¯æ–°å…´çš„ï¼Œæ¯”tlså¿«ä¸€å€
      - tls://8.8.4.4:853#DNS
      - tls://1dot1dot1dot1.cloudflare-dns.com#DNS
  fallback:
   #- tls://8.8.4.4
    - quic://a.passcloud.xyz:784#DNS # quicæ˜¯æ–°å…´çš„ï¼Œæ¯”tlså¿«ä¸€å€
    - tls://8.8.4.4:853#DNS
    - tcp://1.1.1.1#DNS
    - https://1.1.1.1/dns-query#DNS&h3=true
    - https://1.0.0.1/dns-query#DNS
    - tls://1dot1dot1dot1.cloudflare-dns.com#DNS 
  
      
    
  fallback-filter:    # å›½å¤–ç½‘ç«™ä½¿ç”¨æ­¤è§£æ
    geoip: true # é…ç½®æ˜¯å¦ä½¿ç”¨ geoip
    geoip-code: CN
    geosite:      # æ ¹æ®å®é™…æƒ…å†µå†³å®š
      - cn
      
    ipcidr:
      - 240.0.0.0/4
      
    domain:
      - '+.google.com'
      - '+.facebook.com'
      - '+.youtube.com'
      - '+.googleapis.+'     

